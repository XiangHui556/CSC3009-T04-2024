
(tf) C:\Users\krist\Documents\GitHub\CSC3009-T04-2024\NasNetLarge>python NasNetLarge.py
Found 336 images belonging to 4 classes.
Found 96 images belonging to 4 classes.
Found 48 images belonging to 4 classes.
2024-07-08 22:11:22.007260: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-08 22:11:22.581886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9388 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 NASNet (Functional)         (None, 11, 11, 4032)      84916818

 global_average_pooling2d (G  (None, 4032)             0
 lobalAveragePooling2D)

 dropout (Dropout)           (None, 4032)              0

 dense (Dense)               (None, 256)               1032448

 batch_normalization (BatchN  (None, 256)              1024
 ormalization)

 dense_1 (Dense)             (None, 4)                 1028

=================================================================
Total params: 85,951,318
Trainable params: 1,033,988
Non-trainable params: 84,917,330
_________________________________________________________________
Epoch 1/100
2024-07-08 22:11:36.782366: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8100
2024-07-08 22:11:37.961188: I tensorflow/stream_executor/cuda/cuda_blas.cc:1614] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
42/42 [==============================] - ETA: 0s - loss: 1.4500 - accuracy: 0.4226
Epoch 1: val_accuracy improved from -inf to 0.72917, saving model to best_model.h5
42/42 [==============================] - 21s 278ms/step - loss: 1.4500 - accuracy: 0.4226 - val_loss: 1.0060 - val_accuracy: 0.7292
Epoch 2/100
42/42 [==============================] - ETA: 0s - loss: 1.1195 - accuracy: 0.5387
Epoch 2: val_accuracy improved from 0.72917 to 0.78125, saving model to best_model.h5
42/42 [==============================] - 6s 140ms/step - loss: 1.1195 - accuracy: 0.5387 - val_loss: 0.8382 - val_accuracy: 0.7812
Epoch 3/100
42/42 [==============================] - ETA: 0s - loss: 0.9713 - accuracy: 0.6131
Epoch 3: val_accuracy did not improve from 0.78125
42/42 [==============================] - 4s 104ms/step - loss: 0.9713 - accuracy: 0.6131 - val_loss: 0.7349 - val_accuracy: 0.7812
Epoch 4/100
42/42 [==============================] - ETA: 0s - loss: 0.9883 - accuracy: 0.6190
Epoch 4: val_accuracy improved from 0.78125 to 0.82292, saving model to best_model.h5
42/42 [==============================] - 6s 142ms/step - loss: 0.9883 - accuracy: 0.6190 - val_loss: 0.6208 - val_accuracy: 0.8229
Epoch 5/100
42/42 [==============================] - ETA: 0s - loss: 0.7764 - accuracy: 0.7054
Epoch 5: val_accuracy improved from 0.82292 to 0.83333, saving model to best_model.h5
42/42 [==============================] - 6s 140ms/step - loss: 0.7764 - accuracy: 0.7054 - val_loss: 0.5837 - val_accuracy: 0.8333
Epoch 6/100
42/42 [==============================] - ETA: 0s - loss: 0.7517 - accuracy: 0.7232
Epoch 6: val_accuracy improved from 0.83333 to 0.85417, saving model to best_model.h5
42/42 [==============================] - 6s 144ms/step - loss: 0.7517 - accuracy: 0.7232 - val_loss: 0.5346 - val_accuracy: 0.8542
Epoch 7/100
42/42 [==============================] - ETA: 0s - loss: 0.7263 - accuracy: 0.7321
Epoch 7: val_accuracy did not improve from 0.85417
42/42 [==============================] - 4s 104ms/step - loss: 0.7263 - accuracy: 0.7321 - val_loss: 0.4714 - val_accuracy: 0.8542
Epoch 8/100
42/42 [==============================] - ETA: 0s - loss: 0.6693 - accuracy: 0.7679
Epoch 8: val_accuracy did not improve from 0.85417
42/42 [==============================] - 5s 107ms/step - loss: 0.6693 - accuracy: 0.7679 - val_loss: 0.4338 - val_accuracy: 0.8438
Epoch 9/100
42/42 [==============================] - ETA: 0s - loss: 0.6831 - accuracy: 0.7262
Epoch 9: val_accuracy did not improve from 0.85417
42/42 [==============================] - 4s 105ms/step - loss: 0.6831 - accuracy: 0.7262 - val_loss: 0.4116 - val_accuracy: 0.8333
Epoch 10/100
42/42 [==============================] - ETA: 0s - loss: 0.6650 - accuracy: 0.7589
Epoch 10: val_accuracy did not improve from 0.85417
42/42 [==============================] - 4s 105ms/step - loss: 0.6650 - accuracy: 0.7589 - val_loss: 0.3847 - val_accuracy: 0.8542
Epoch 11/100
42/42 [==============================] - ETA: 0s - loss: 0.5918 - accuracy: 0.7768
Epoch 11: val_accuracy did not improve from 0.85417
42/42 [==============================] - 4s 105ms/step - loss: 0.5918 - accuracy: 0.7768 - val_loss: 0.3884 - val_accuracy: 0.8438
Epoch 12/100
42/42 [==============================] - ETA: 0s - loss: 0.6272 - accuracy: 0.7440
Epoch 12: val_accuracy improved from 0.85417 to 0.88542, saving model to best_model.h5
42/42 [==============================] - 6s 147ms/step - loss: 0.6272 - accuracy: 0.7440 - val_loss: 0.3793 - val_accuracy: 0.8854
Epoch 13/100
42/42 [==============================] - ETA: 0s - loss: 0.6887 - accuracy: 0.7351
Epoch 13: val_accuracy did not improve from 0.88542
42/42 [==============================] - 4s 104ms/step - loss: 0.6887 - accuracy: 0.7351 - val_loss: 0.3931 - val_accuracy: 0.8542
Epoch 14/100
42/42 [==============================] - ETA: 0s - loss: 0.5778 - accuracy: 0.7827
Epoch 14: val_accuracy did not improve from 0.88542
42/42 [==============================] - 4s 103ms/step - loss: 0.5778 - accuracy: 0.7827 - val_loss: 0.3765 - val_accuracy: 0.8750
Epoch 15/100
42/42 [==============================] - ETA: 0s - loss: 0.4857 - accuracy: 0.8274
Epoch 15: val_accuracy did not improve from 0.88542
42/42 [==============================] - 4s 106ms/step - loss: 0.4857 - accuracy: 0.8274 - val_loss: 0.3718 - val_accuracy: 0.8646
Epoch 16/100
42/42 [==============================] - ETA: 0s - loss: 0.5324 - accuracy: 0.7887
Epoch 16: val_accuracy did not improve from 0.88542
42/42 [==============================] - 4s 102ms/step - loss: 0.5324 - accuracy: 0.7887 - val_loss: 0.3618 - val_accuracy: 0.8542
Epoch 17/100
42/42 [==============================] - ETA: 0s - loss: 0.5671 - accuracy: 0.7411
Epoch 17: val_accuracy did not improve from 0.88542
42/42 [==============================] - 4s 104ms/step - loss: 0.5671 - accuracy: 0.7411 - val_loss: 0.3725 - val_accuracy: 0.8750
Epoch 18/100
42/42 [==============================] - ETA: 0s - loss: 0.5728 - accuracy: 0.7708
Epoch 18: val_accuracy improved from 0.88542 to 0.89583, saving model to best_model.h5
42/42 [==============================] - 6s 149ms/step - loss: 0.5728 - accuracy: 0.7708 - val_loss: 0.3697 - val_accuracy: 0.8958
Epoch 19/100
42/42 [==============================] - ETA: 0s - loss: 0.5677 - accuracy: 0.7887
Epoch 19: val_accuracy did not improve from 0.89583
42/42 [==============================] - 5s 111ms/step - loss: 0.5677 - accuracy: 0.7887 - val_loss: 0.3875 - val_accuracy: 0.8646
Epoch 20/100
42/42 [==============================] - ETA: 0s - loss: 0.5517 - accuracy: 0.7917
Epoch 20: val_accuracy improved from 0.89583 to 0.90625, saving model to best_model.h5
42/42 [==============================] - 6s 148ms/step - loss: 0.5517 - accuracy: 0.7917 - val_loss: 0.3381 - val_accuracy: 0.9062
Epoch 21/100
42/42 [==============================] - ETA: 0s - loss: 0.5760 - accuracy: 0.7649
Epoch 21: val_accuracy did not improve from 0.90625
42/42 [==============================] - 5s 106ms/step - loss: 0.5760 - accuracy: 0.7649 - val_loss: 0.3453 - val_accuracy: 0.9062
Epoch 22/100
42/42 [==============================] - ETA: 0s - loss: 0.4241 - accuracy: 0.8512
Epoch 22: val_accuracy did not improve from 0.90625
42/42 [==============================] - 4s 106ms/step - loss: 0.4241 - accuracy: 0.8512 - val_loss: 0.3552 - val_accuracy: 0.8958
Epoch 23/100
42/42 [==============================] - ETA: 0s - loss: 0.5071 - accuracy: 0.8036
Epoch 23: val_accuracy did not improve from 0.90625
42/42 [==============================] - 5s 107ms/step - loss: 0.5071 - accuracy: 0.8036 - val_loss: 0.3299 - val_accuracy: 0.8854
Epoch 24/100
42/42 [==============================] - ETA: 0s - loss: 0.5049 - accuracy: 0.8125
Epoch 24: val_accuracy did not improve from 0.90625
42/42 [==============================] - 5s 107ms/step - loss: 0.5049 - accuracy: 0.8125 - val_loss: 0.3620 - val_accuracy: 0.8646
Epoch 25/100
42/42 [==============================] - ETA: 0s - loss: 0.4918 - accuracy: 0.8363
Epoch 25: val_accuracy did not improve from 0.90625
42/42 [==============================] - 5s 106ms/step - loss: 0.4918 - accuracy: 0.8363 - val_loss: 0.3506 - val_accuracy: 0.8750
Epoch 26/100
42/42 [==============================] - ETA: 0s - loss: 0.4571 - accuracy: 0.8363
Epoch 26: val_accuracy did not improve from 0.90625
42/42 [==============================] - 4s 103ms/step - loss: 0.4571 - accuracy: 0.8363 - val_loss: 0.3404 - val_accuracy: 0.8854
Epoch 27/100
42/42 [==============================] - ETA: 0s - loss: 0.5264 - accuracy: 0.8155
Epoch 27: val_accuracy did not improve from 0.90625
42/42 [==============================] - 4s 105ms/step - loss: 0.5264 - accuracy: 0.8155 - val_loss: 0.3376 - val_accuracy: 0.8958
Epoch 28/100
42/42 [==============================] - ETA: 0s - loss: 0.4433 - accuracy: 0.8155
Epoch 28: val_accuracy did not improve from 0.90625
42/42 [==============================] - 4s 105ms/step - loss: 0.4433 - accuracy: 0.8155 - val_loss: 0.3319 - val_accuracy: 0.8854
Epoch 29/100
42/42 [==============================] - ETA: 0s - loss: 0.5295 - accuracy: 0.7976
Epoch 29: val_accuracy improved from 0.90625 to 0.91667, saving model to best_model.h5
42/42 [==============================] - 6s 148ms/step - loss: 0.5295 - accuracy: 0.7976 - val_loss: 0.2977 - val_accuracy: 0.9167
Epoch 30/100
42/42 [==============================] - ETA: 0s - loss: 0.4042 - accuracy: 0.8482
Epoch 30: val_accuracy did not improve from 0.91667
42/42 [==============================] - 4s 106ms/step - loss: 0.4042 - accuracy: 0.8482 - val_loss: 0.3013 - val_accuracy: 0.9167
Epoch 31/100
42/42 [==============================] - ETA: 0s - loss: 0.3821 - accuracy: 0.8393
Epoch 31: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 106ms/step - loss: 0.3821 - accuracy: 0.8393 - val_loss: 0.3152 - val_accuracy: 0.9062
Epoch 32/100
42/42 [==============================] - ETA: 0s - loss: 0.3952 - accuracy: 0.8601
Epoch 32: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 106ms/step - loss: 0.3952 - accuracy: 0.8601 - val_loss: 0.3138 - val_accuracy: 0.8854
Epoch 33/100
42/42 [==============================] - ETA: 0s - loss: 0.4085 - accuracy: 0.8333
Epoch 33: val_accuracy did not improve from 0.91667
42/42 [==============================] - 4s 101ms/step - loss: 0.4085 - accuracy: 0.8333 - val_loss: 0.3177 - val_accuracy: 0.8854
Epoch 34/100
42/42 [==============================] - ETA: 0s - loss: 0.3999 - accuracy: 0.8661
Epoch 34: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 106ms/step - loss: 0.3999 - accuracy: 0.8661 - val_loss: 0.2987 - val_accuracy: 0.8854
Epoch 35/100
42/42 [==============================] - ETA: 0s - loss: 0.4315 - accuracy: 0.8304
Epoch 35: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 108ms/step - loss: 0.4315 - accuracy: 0.8304 - val_loss: 0.3116 - val_accuracy: 0.8750
Epoch 36/100
42/42 [==============================] - ETA: 0s - loss: 0.4798 - accuracy: 0.8304
Epoch 36: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 108ms/step - loss: 0.4798 - accuracy: 0.8304 - val_loss: 0.3041 - val_accuracy: 0.8958
Epoch 37/100
42/42 [==============================] - ETA: 0s - loss: 0.4106 - accuracy: 0.8185
Epoch 37: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 109ms/step - loss: 0.4106 - accuracy: 0.8185 - val_loss: 0.3058 - val_accuracy: 0.8958
Epoch 38/100
42/42 [==============================] - ETA: 0s - loss: 0.3875 - accuracy: 0.8482
Epoch 38: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 106ms/step - loss: 0.3875 - accuracy: 0.8482 - val_loss: 0.3144 - val_accuracy: 0.8854
Epoch 39/100
42/42 [==============================] - ETA: 0s - loss: 0.4214 - accuracy: 0.8452
Epoch 39: val_accuracy did not improve from 0.91667
42/42 [==============================] - 5s 122ms/step - loss: 0.4214 - accuracy: 0.8452 - val_loss: 0.3110 - val_accuracy: 0.8958
12/12 [==============================] - 4s 63ms/step - loss: 0.2977 - accuracy: 0.9167
Best Parameters: {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
Val Accuracy: 0.9166666865348816
Val Loss: 0.2977418303489685
6/6 [==============================] - 0s 63ms/step - loss: 0.3080 - accuracy: 0.8958
Test Accuracy: 0.8958
Test Loss: 0.3080
6/6 [==============================] - 4s 99ms/step
Classification Report:

              precision    recall  f1-score   support

      glioma       0.91      0.83      0.87        12
  meningioma       0.85      0.92      0.88        12
   pituitary       1.00      0.83      0.91        12
     notumor       0.86      1.00      0.92        12

    accuracy                           0.90        48
   macro avg       0.90      0.90      0.90        48
weighted avg       0.90      0.90      0.90        48