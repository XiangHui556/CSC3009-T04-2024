(tf) C:\Users\krist\Documents\GitHub\CSC3009-T04-2024\NasNetLarge>python NasNetLarge.py
Found 336 images belonging to 4 classes.
Found 96 images belonging to 4 classes.
Found 48 images belonging to 4 classes.
2024-07-08 18:34:39.126581: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-08 18:34:39.533658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9388 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 NASNet (Functional)         (None, 11, 11, 4032)      84916818

 dropout (Dropout)           (None, 11, 11, 4032)      0

 flatten (Flatten)           (None, 487872)            0

 batch_normalization (BatchN  (None, 487872)           1951488
 ormalization)

 dense (Dense)               (None, 32)                15611936

 batch_normalization_1 (Batc  (None, 32)               128
 hNormalization)

 activation_260 (Activation)  (None, 32)               0

 dropout_1 (Dropout)         (None, 32)                0

 dense_1 (Dense)             (None, 32)                1056

 batch_normalization_2 (Batc  (None, 32)               128
 hNormalization)

 activation_261 (Activation)  (None, 32)               0

 dropout_2 (Dropout)         (None, 32)                0

 dense_2 (Dense)             (None, 32)                1056

 batch_normalization_3 (Batc  (None, 32)               128
 hNormalization)

 activation_262 (Activation)  (None, 32)               0

 dense_3 (Dense)             (None, 4)                 132

=================================================================
Total params: 102,482,870
Trainable params: 16,590,116
Non-trainable params: 85,892,754
_________________________________________________________________
Epoch 1/25
2024-07-08 18:34:54.660944: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8100
2024-07-08 18:34:55.825778: I tensorflow/stream_executor/cuda/cuda_blas.cc:1614] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
11/11 [==============================] - ETA: 0s - loss: 1.5054 - accuracy: 0.3304
Epoch 1: val_accuracy improved from -inf to 0.28125, saving model to best_model.h5
11/11 [==============================] - 20s 908ms/step - loss: 1.5054 - accuracy: 0.3304 - val_loss: 2.5509 - val_accuracy: 0.2812
Epoch 2/25
11/11 [==============================] - ETA: 0s - loss: 1.3826 - accuracy: 0.3423
Epoch 2: val_accuracy improved from 0.28125 to 0.35417, saving model to best_model.h5
11/11 [==============================] - 7s 631ms/step - loss: 1.3826 - accuracy: 0.3423 - val_loss: 1.8428 - val_accuracy: 0.3542
Epoch 3/25
11/11 [==============================] - ETA: 0s - loss: 1.4131 - accuracy: 0.3125
Epoch 3: val_accuracy improved from 0.35417 to 0.40625, saving model to best_model.h5
11/11 [==============================] - 6s 593ms/step - loss: 1.4131 - accuracy: 0.3125 - val_loss: 1.4266 - val_accuracy: 0.4062
Epoch 4/25
11/11 [==============================] - ETA: 0s - loss: 1.2980 - accuracy: 0.3929
Epoch 4: val_accuracy improved from 0.40625 to 0.53125, saving model to best_model.h5
11/11 [==============================] - 7s 600ms/step - loss: 1.2980 - accuracy: 0.3929 - val_loss: 1.2139 - val_accuracy: 0.5312
Epoch 5/25
11/11 [==============================] - ETA: 0s - loss: 1.2821 - accuracy: 0.4167
Epoch 5: val_accuracy improved from 0.53125 to 0.56250, saving model to best_model.h5
11/11 [==============================] - 6s 573ms/step - loss: 1.2821 - accuracy: 0.4167 - val_loss: 1.1351 - val_accuracy: 0.5625
Epoch 6/25
11/11 [==============================] - ETA: 0s - loss: 1.2356 - accuracy: 0.4137
Epoch 6: val_accuracy improved from 0.56250 to 0.59375, saving model to best_model.h5
11/11 [==============================] - 6s 556ms/step - loss: 1.2356 - accuracy: 0.4137 - val_loss: 1.0890 - val_accuracy: 0.5938
Epoch 7/25
11/11 [==============================] - ETA: 0s - loss: 1.2075 - accuracy: 0.4494
Epoch 7: val_accuracy did not improve from 0.59375
11/11 [==============================] - 5s 426ms/step - loss: 1.2075 - accuracy: 0.4494 - val_loss: 1.0327 - val_accuracy: 0.5833
Epoch 8/25
11/11 [==============================] - ETA: 0s - loss: 1.2298 - accuracy: 0.4494
Epoch 8: val_accuracy improved from 0.59375 to 0.64583, saving model to best_model.h5
11/11 [==============================] - 6s 584ms/step - loss: 1.2298 - accuracy: 0.4494 - val_loss: 0.9234 - val_accuracy: 0.6458
Epoch 9/25
11/11 [==============================] - ETA: 0s - loss: 1.1756 - accuracy: 0.4583
Epoch 9: val_accuracy improved from 0.64583 to 0.69792, saving model to best_model.h5
11/11 [==============================] - 6s 565ms/step - loss: 1.1756 - accuracy: 0.4583 - val_loss: 0.8670 - val_accuracy: 0.6979
Epoch 10/25
11/11 [==============================] - ETA: 0s - loss: 1.2117 - accuracy: 0.4613
Epoch 10: val_accuracy improved from 0.69792 to 0.71875, saving model to best_model.h5
11/11 [==============================] - 6s 552ms/step - loss: 1.2117 - accuracy: 0.4613 - val_loss: 0.8474 - val_accuracy: 0.7188
Epoch 11/25
11/11 [==============================] - ETA: 0s - loss: 1.1843 - accuracy: 0.4792
Epoch 11: val_accuracy improved from 0.71875 to 0.75000, saving model to best_model.h5
11/11 [==============================] - 6s 550ms/step - loss: 1.1843 - accuracy: 0.4792 - val_loss: 0.8245 - val_accuracy: 0.7500
Epoch 12/25
11/11 [==============================] - ETA: 0s - loss: 1.0867 - accuracy: 0.5089
Epoch 12: val_accuracy did not improve from 0.75000
11/11 [==============================] - 5s 426ms/step - loss: 1.0867 - accuracy: 0.5089 - val_loss: 0.8224 - val_accuracy: 0.7500
Epoch 13/25
11/11 [==============================] - ETA: 0s - loss: 1.1755 - accuracy: 0.4554
Epoch 13: val_accuracy improved from 0.75000 to 0.77083, saving model to best_model.h5
11/11 [==============================] - 6s 568ms/step - loss: 1.1755 - accuracy: 0.4554 - val_loss: 0.8190 - val_accuracy: 0.7708
Epoch 14/25
11/11 [==============================] - ETA: 0s - loss: 1.0884 - accuracy: 0.5446
Epoch 14: val_accuracy did not improve from 0.77083
11/11 [==============================] - 5s 429ms/step - loss: 1.0884 - accuracy: 0.5446 - val_loss: 0.8165 - val_accuracy: 0.7604
Epoch 15/25
11/11 [==============================] - ETA: 0s - loss: 1.1137 - accuracy: 0.5119
Epoch 15: val_accuracy did not improve from 0.77083
11/11 [==============================] - 5s 429ms/step - loss: 1.1137 - accuracy: 0.5119 - val_loss: 0.8179 - val_accuracy: 0.7604
Epoch 16/25
11/11 [==============================] - ETA: 0s - loss: 1.1408 - accuracy: 0.4732
Epoch 16: val_accuracy did not improve from 0.77083
11/11 [==============================] - 5s 433ms/step - loss: 1.1408 - accuracy: 0.4732 - val_loss: 0.8099 - val_accuracy: 0.7604
Epoch 17/25
11/11 [==============================] - ETA: 0s - loss: 1.0952 - accuracy: 0.5030
Epoch 17: val_accuracy improved from 0.77083 to 0.80208, saving model to best_model.h5
11/11 [==============================] - 6s 555ms/step - loss: 1.0952 - accuracy: 0.5030 - val_loss: 0.8089 - val_accuracy: 0.8021
Epoch 18/25
11/11 [==============================] - ETA: 0s - loss: 1.1219 - accuracy: 0.4970
Epoch 18: val_accuracy improved from 0.80208 to 0.82292, saving model to best_model.h5
11/11 [==============================] - 6s 558ms/step - loss: 1.1219 - accuracy: 0.4970 - val_loss: 0.8050 - val_accuracy: 0.8229
Epoch 19/25
11/11 [==============================] - ETA: 0s - loss: 1.0689 - accuracy: 0.5774
Epoch 19: val_accuracy did not improve from 0.82292
11/11 [==============================] - 5s 417ms/step - loss: 1.0689 - accuracy: 0.5774 - val_loss: 0.8055 - val_accuracy: 0.8229
Epoch 20/25
11/11 [==============================] - ETA: 0s - loss: 1.0896 - accuracy: 0.5268
Epoch 20: val_accuracy improved from 0.82292 to 0.83333, saving model to best_model.h5
11/11 [==============================] - 6s 556ms/step - loss: 1.0896 - accuracy: 0.5268 - val_loss: 0.8020 - val_accuracy: 0.8333
Epoch 21/25
11/11 [==============================] - ETA: 0s - loss: 1.0893 - accuracy: 0.5268
Epoch 21: val_accuracy improved from 0.83333 to 0.84375, saving model to best_model.h5
11/11 [==============================] - 6s 562ms/step - loss: 1.0893 - accuracy: 0.5268 - val_loss: 0.8011 - val_accuracy: 0.8438
Epoch 22/25
11/11 [==============================] - ETA: 0s - loss: 1.0799 - accuracy: 0.5417
Epoch 22: val_accuracy did not improve from 0.84375
11/11 [==============================] - 5s 420ms/step - loss: 1.0799 - accuracy: 0.5417 - val_loss: 0.8016 - val_accuracy: 0.8333
Epoch 23/25
11/11 [==============================] - ETA: 0s - loss: 1.0555 - accuracy: 0.5446
Epoch 23: val_accuracy did not improve from 0.84375
11/11 [==============================] - 5s 445ms/step - loss: 1.0555 - accuracy: 0.5446 - val_loss: 0.8069 - val_accuracy: 0.7917
Epoch 24/25
11/11 [==============================] - ETA: 0s - loss: 1.0709 - accuracy: 0.5357
Epoch 24: val_accuracy did not improve from 0.84375
11/11 [==============================] - 5s 423ms/step - loss: 1.0709 - accuracy: 0.5357 - val_loss: 0.8044 - val_accuracy: 0.8229
Epoch 25/25
11/11 [==============================] - ETA: 0s - loss: 1.0905 - accuracy: 0.5298
Epoch 25: val_accuracy improved from 0.84375 to 0.85417, saving model to best_model.h5
11/11 [==============================] - 6s 539ms/step - loss: 1.0905 - accuracy: 0.5298 - val_loss: 0.8003 - val_accuracy: 0.8542
3/3 [==============================] - 4s 249ms/step - loss: 0.8003 - accuracy: 0.8542
Best Parameters: {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
Val Accuracy: 0.8541666865348816
Val Loss: 0.8003031611442566
2/2 [==============================] - 0s 125ms/step - loss: 0.9249 - accuracy: 0.7292
Test Accuracy: 0.7292
Test Loss: 0.9249
2/2 [==============================] - 3s 318ms/step
Classification Report:

              precision    recall  f1-score   support

      glioma       0.57      1.00      0.73        12
  meningioma       1.00      0.25      0.40        12
   pituitary       0.89      0.67      0.76        12
     notumor       0.80      1.00      0.89        12

    accuracy                           0.73        48
   macro avg       0.82      0.73      0.69        48
weighted avg       0.82      0.73      0.69        48